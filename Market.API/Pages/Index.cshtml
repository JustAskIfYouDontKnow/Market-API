@page "index" 

<!DOCTYPE html>
<html>
<head>
	<title>Example Page</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
	<style>
		body {
			font-family: Arial, sans-serif;
			font-size: 16px;
			line-height: 1.4;
			color: #333;
		}

		.search-section {
			margin: 20px 0;
			border: 1px solid #ddd;
			padding: 20px;
			display: flex;
			flex-direction: column;
			align-items: center;
			text-align: center;
		}

		form {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 10px;
			margin-bottom: 20px;
			width: 100%;
			max-width: 500px;
		}

		label {
			font-weight: bold;
			display: block;
		}

		input[type="number"] {
			width: 100%;
			padding: 8px;
			font-size: 16px;
			border: 1px solid #ddd;
			border-radius: 3px;
			box-sizing: border-box;
		}

		button[type="submit"] {
			padding: 8px 16px;
			font-size: 16px;
			font-weight: bold;
			color: #fff;
			background-color: #007bff;

border: none;
border-radius: 3px;
cursor: pointer;
transition: background-color 0.2s ease;
}
	button[type="submit"]:hover {
		background-color: #0069d9;
	}

	table {
		width: 100%;
		border-collapse: collapse;
	}

	th, td {
		padding: 8px;
		text-align: left;
		border-bottom: 1px solid #ddd;
	}

	th {
		background-color: #f2f2f2;
		font-weight: bold;
		color: #333;
	}

	tr:hover {
		background-color: #f5f5f5;
	}
</style>
</head>
<body>
	<div class="container">
		<div class="search-section">
			<h1>Поиск пользователей</h1>
			<form id="one-user-form">
				<label for="search">Введите ID пользователя:</label>
				<input type="number" id="search" name="search" placeholder="ID пользователя" required>
				<button type="submit">Найти</button>
			</form>
			<form id="all-users-form">
            	<label for="search">Найти всех пользователей:</label>
            	<button type="submit">Найти</button>
            </form>
		</div>
		<table>
		<thead>
			<tr>
				<th>ID</th>
				<th>Имя</th>
				<th>Фамилия</th>
			</tr>
		</thead>
		<tbody id="user-table-body"></tbody>
	</table>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script>
	const getOneUserForm = document.querySelector('#one-user-form');
	const userTableBody = document.querySelector('#user-table-body');
	const allUsersForm = document.querySelector('#all-users-form');
	const searchButtons = document.querySelectorAll('button[type="submit"]');
    
   
	getOneUserForm.addEventListener('submit', async event => {
		event.preventDefault();
		searchButtons.forEach(searchButton => {
                                    searchButton.addEventListener('click', async event => {
                                        event.preventDefault();
                                        if (searchButton.textContent === "Найти") {
                                            searchButton.textContent = "Закрыть";
                                            searchButton.style.backgroundColor = "red";
											const userId = document.querySelector('#search').value;
                                            		try {
                                            			const response = await fetch(`https://jsonplaceholder.typicode.com/users/${userId}`);
                                            			if (!response.ok) {
                                            				throw new Error('Ошибка получения данных');
                                            			}
                                            			const user = await response.json();
                                            			userTableBody.innerHTML = `<tr><td>${user.id}</td><td>${user.name}</td><td>${user.username}</td></tr>`;
                                            		} catch (error) {
                                            			console.error(error);
                                            			userTableBody.innerHTML = '<tr><td colspan="3">Пользователь не найден</td></tr>';
                                            		}
										} else 
										{
                                            searchButton.textContent = "Найти";
                                            searchButton.style.backgroundColor = "#007bff";
                                            userTableBody.innerHTML = '';
										}
										                         });
                                                                });
                                        
                                            });
										
                                                                               
	
	allUsersForm.addEventListener('submit', async event => {
    	event.preventDefault();
		
		searchButtons.forEach(searchButton => {
                            searchButton.addEventListener('click', async event => {
                                event.preventDefault();
                                if (searchButton.textContent === "Найти") {
                                    searchButton.textContent = "Закрыть";
                                    searchButton.style.backgroundColor = "red";
									try {
                                        		const response = await fetch('http://localhost:5000/api/User/GetAllUsers');
                                        		if (!response.ok) {
                                        			throw new Error('Ошибка получения данных');
                                        		}
                                        		const users = await response.json();
                                        		let tableBody = '';
                                        		users.forEach(user => {
                                        			tableBody += `<tr><td>${user.id}</td><td>${user.firstName}</td><td>${user.lastName}</td></tr>`;
                                        		});
                                        		userTableBody.innerHTML = tableBody;
                                        	} catch (error) {
                                        		console.error(error);
                                        		userTableBody.innerHTML = '<tr><td colspan="3">Ошибка получения данных</td></tr>';
                                        	}
                                } else {
                                    searchButton.textContent = "Найти";
                                    searchButton.style.backgroundColor = "#007bff";
                                    userTableBody.innerHTML = '';
                                }
                            });
                        });

    });
	


</script>
</body>
</html>